{% extends "base.html" %} {% block body %}

<div class="container mt-5">
  <h2>All Courses & Assignments</h2>

  <div class="mb-3 mt-3 w-30"></div>
  {% if courses_with_assignments %} {% for item in courses_with_assignments %}

  <!-- Course Card -->
  <div class="card mt-4">
    <!-- Course Header -->
    <div class="card-header bg-primary text-white">
      <h5>
        {{ item.course.code }} - {{ item.course.title }}
        <span class="badge bg-light text-dark float-end">
          {{ item.assignment_count }} Assignment(s)
        </span>
      </h5>
      <small>
        Professor: {{ item.course.professor }} | Credits: {{ item.course.credits
        }} | Format: {{ item.course.format }}
      </small>
    </div>

    <!-- Assignments Table -->
    <div class="card-body">
      {% if item.assignments %}
      <table class="table table-striped table-hover">
        <thead class="table-secondary">
          <tr>
            <th>#</th>
            <th>Assignment Title</th>
            <th>Description</th>
            <th>Due Date</th>
            <th>Max Points</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for assignment in item.assignments %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>
              <a
                href="{{ url_for('assignments.assignment_detail', assignment_id=assignment.id) }}"
                class="fw-bold"
                >{{ assignment.title }}</a
              >
            </td>
            <td>
              <small>
                {{ assignment.description[:80] }} {% if
                assignment.description|length > 80 %}...{% endif %}
              </small>
            </td>
            <td>
              {% if assignment.due_date %} {{ assignment.due_date.strftime('%b
              %d, %Y') }} {% else %}
              <span class="text-muted">No due date</span>
              {% endif %}
            </td>
            <td>{{ assignment.max_points }} pts</td>
            <td>
              <small class="text-muted">
                {{ assignment.created_at.strftime('%b %d, %Y') }}
              </small>
            </td>
            <td>
              Mark as completed |
              <a
                href="{{ url_for('assignments.assignment_detail', assignment_id=assignment.id) }}"
                >
                Edit</a
              >
              | Delete
            </td>
          </tr>

          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <!-- No assignments for this course -->
      <p class="alert alert-info mb-0">
        <i class="bi bi-info-circle"></i> No assignments created for this course
        yet.
      </p>
      {% endif %}
    </div>
  </div>

  {% endfor %}

  <!-- Summary -->
  <div class="mt-4 alert alert-secondary">
    <strong>Total:</strong> {{ courses_with_assignments|length }} courses
  </div>

  {% else %}
  <!-- No courses exist -->
  <p class="alert alert-warning mt-3">No courses available in the system.</p>
  {% endif %}
</div>

{% endblock %}
